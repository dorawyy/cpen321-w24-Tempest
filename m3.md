
# M3 - Requirements and Design

## 1. Change History
<!-- Leave blank for M3 -->

## 2. Project Description

**Tempest** is a reimagined weather and news application designed to prioritize critical information about natural disasters, such as wildfires, tornadoes, hurricanes, and other intense weather.
 The app delivers real-time updates and localized alerts for users to stay informed and prepared in the face of extreme weather events.

## 3. Requirements Specification
### **3.1. Use-Case Diagram**
![image](documentation/images/use-caseDiagram.jpeg)

### **3.2. Actors Description**
1. **[Unauthenticated User]**: Unauthenticated Users can interact with the map to get information about the weather conditions in there area...
2. **[Authenticated User]**: Authenticated Users can interact with the app with all the same priviliges as a User, but can also enable push notifications and comments.
2. **[Admin]**: Admins have the capacity to manage comments by removing or modifying unwanted comments.


### **3.3. Functional Requirements**
<a name="fr1"></a>

1. **Users can create an account with localization information to be notified of extreme weather nearby** 
    - **Overview**:
        1. Users can create an account and authenticate with known platforms like Google and Facebook
        2. Users can toggle between different weather layers on the map to display different weather visualizations
        3. Authenticated Users can enable notifications for extreme weather in their area
        4. Authenticated Users can comment on extreme weather pings to add additional information
        5. Users can enable "predictive weather" which shows where the weather event is likely to go
        6. Admins can remove comments

    
    - **Detailed Flow for Each Independent Scenario**: 
        1. **[Account Creation and Authentication]**:
            - **Description**: Users can use Facebook or Google to authenticate and create an accoun
            - **Primary actor(s)**: Users
            - **Main success scenario**:
                1. Users click on the "Login" button
                2. Users choose to authenticate with either Facebook or Google
                3. Users login with the respective service
                4. Users are redirected to the account page where they can enter a nickname for anonymity
            - **Failure scenario(s)**:
                - 2a. ...
                    - 2a1. ...
                    - 2a2. ...
               
                

       2. **[Toggling the Weather Layers]**:
            - **Description**: Users have the option to toggle between Wildfire Data, Tornado Data, Hurricane Data, or just the basic map. 
            - **Primary actor(s)**: Users
            - **Main success scenario**:
                1. Users selects which layer to toggle
                2. Map removes the previous visible layer, and displays the new selected animation on the screen.
            - **Failure scenario(s)**:
                - 2a.
        3. **[Authenticated Users can enable notifications for extreme weather in their area]**:
            - **Description**: Authenticated Users can go into their accound and enable push notifications. They will need to accpet to share their location information if they have not already.
            - **Primary actor(s)**: Authenticated Users
            - **Main success scenario**:
                1. User clicks on "enable local weather notifications" in their account
                2. Users are prompted to enable location services
                3. Users enable location services
                4. Users are prompted to enable push notifications
                5. Users enable push notifications

            - **Failure scenario(s)**:
                 - 2a. Users decline to enable location services
                    - 6a1. A pop-up tells users location services are required to enable push notifications
                    - 6a2. Steps 7 and 8 are skipped.
                    - 6a3. A button to enable location services is now present in the Account page
                - 4a. Users decline to enable push notifications
                    - 8a1. A pop-up tells users notifications help get users the most up-to-date information
                    - 8a2. A button to enable push notifications is now present in the Account page

        4. **[Authenticated Users can comment on extreme weather pings]**:
            - **Description**: Authenticated Users have the ability to leave messages on extreme weather to let others know about important information such as safe houses, supplies or other important knowledge in their vicinity. Users are able to read this information but cannot add their own information.
            - **Primary actor(s)**: Authenticated Users, Users 
            - **Main success scenario**:
                1. Authenticated User clicks on the extreme weather event
                2. Authenticated User inputs text message in comment box
                3. User clicks on "Add Comment" button
                4. Comment is added to the extreme weather event ping

            - **Failure scenario(s)**:
                 - 2a. User did not input a valid text 
                    - 2a1. An error will appear next to the text box saying "Input text was not valid, please enter a valid message"
                - 4a. The comment does not reach the server
                    - 4a1. An error will appear next to the text box saying "Message could not reach server, please try again later"
        
        5. **[Users can enable "predictive weather" which shows where the weather event is likely to go]**:
            - **Description**: Users can check a box on the map that allows them to see future movement of the exreme weather event they are currently on. This works for Wildfire Spreading, Tornado direction, and Hurricane direction.
            - **Main success scenario**:
                1. User clicks on "Enable Predictive Weather" button
                2. The Map adds a new overlay on top of the current layer without removing the current layer.

            - **Failure scenario(s)**:

        6. **[Admins can remove comments]**:
            - **Description**: Admins have the capacity to remove messages from the list of messages on any given extreme weather event if they deem them 
            - **Main success scenario**:
                1. Admin clicks on extreme weather event ping
                2. Admin can scroll through comments
                3. Admin can click on a comment
                4. A prompt asking "Do you wish to delete this comment" will appear
                5. Admin clicks on "Yes"
                6. Comment is deleted

            - **Failure scenario(s)**:
                -6.a. Comment is not deleted
                    - An error is returned saying "Failed to delete comment, please try again soon."
                
    

   


### **3.4. Screen Mockups**


### **3.5. Non-Functional Requirements**
<a name="nfr1"></a>

1. **[Notification Speed]**
    - **Description**: Users must receive notifications within 10 seconds of the information being publicly available.
    - **Justification**: When dealing with a natural disaster, it is important that users have access to the information as soon as possible to ensure maximum safety. [performance]
2. **[User Privacy]**
    - **Description**: No User's account information, other than nickname, will ever be accessible to any other User
    - **Justification**: Users have a right to not disclose private information such as email, name, etc. If users choose to set a nickname, only this will be displayed to other Users on the application [security]


## 4. Designs Specification
### **4.1. Main Components**

1. **Authentication**
    - **Purpose**: The authentication component authenticates a user with their Google or Facebook accounts allowing them to become a “Authenticated User” actor in the app. 
    - **Rationale**: This component in the application is used to create an identity for a user allowing them interact with social features and receive personalized integration
    - **Interfaces**: 
        1. UserSession exchangeAuthorizationCode(String authorizationCode, String redirectUri);
            - **Purpose**: Exchanges the provided authorization code for access and ID tokens creating a user session
        2. boolean validateIdToken(String idToken);
            - **Purpose**: Validate the IdToken of the user 
        3. String refreshAccessToken(String refreshToken);
            - **Purpose**: Refresh the access token 
        4. void logoutUser(String userId);
            - **Purpose**: Logout a user using the userId

2. **Map**
    - **Purpose**: The map component displays extreme weather conditions globally where users can view, comment, and learn about resources on individual weather disasters
    - **Rationale**: This component is necessary to provide a visual for users to access accessible weather information. A map-based UI is more engaging and intituitve improving UI/UX.
    - **Interfaces**: 
        1. List<WeatherEvent> getExtremeWeatherEvents(Double latitude, Double longitude);
            - **Purpose**: Retrieves a list of extreme weather events based on location
        2. List<WeatherEvent> getMapExtremeWeatherEvents();
            - **Purpose**: Get all global extreme weather events to display on the map
        3. WeatherEventDetails getEventDetails(String eventId);
            - **Purpose**: Get individual event information from the database such as comments


3. **Comment**
    - **Purpose**: The comment component interact closely withe the map component to allow comments to populate on the map and provide functionality to make and remove remarks.
    - **Rationale**: This component is necessary to provide user and admin access in manipulate the comments section of an event. By decoupling this from the Map component, it is easier to debug and manage commnets with a seperate component
    - **Interfaces**: 
        1. void postComment(String eventId, String userId, String comment);
            - **Purpose**: Post comment from a user on specific event
        2. List<Comment> getEventComments(String eventId);
            - **Purpose**: List specific comments of an event
        3. void removeEventComments(List<UUID> commentId);
            - **Purpose**: Remove all or an individual event commnets

4. **Notification**
    - **Purpose**: The notification component help notify users of local extreme weather conditions through their communication method of choice
    - **Rationale**: This component primarily acts in the backend constantly checking for extreme weathers for our user base. This is necessary as a component itself as there are no frontend feature coupled with this component and acts as an individual entity.
    - **Intefaces**:
        1. void notifyUser (String eventId, String userId):
            - **Purpose**: Notify a user with a specific event
        2. List<Users> checkLocalUsers (String eventId):
            - **Purpose**: Return a list of Users that is affect by the specified event

### **4.2. Databases**
1. **File Based Storage (S3)**
    - **Purpose**: Store sterilized and filtered training data
2. **NoSQL (Dynamo DB)**
    - **Purpose**: Store user information, weather, comments, notifications and other application data

### **4.3. External Modules**
1. **[Google Maps](https://developers.google.com/maps)** 
    - **Purpose**: Display map data for the app
2. **[Google Authentication](https://developer.android.com/identity/sign-in/credential-manager-siwg)**
    - **Purpose**: Handle Sign In with Google
3. **[NASA Fire Information for Resource Management System](https://firms.modaps.eosdis.nasa.gov/api/)** 
    - **Purpose**: Collect wild fire information from NASA
4. **[Open Weather](https://openweathermap.org/api)**
    - **Purpose**: Provides weather meta
5. **[Scikit-Learn](https://scikit-learn.org/)**
    - **Purpose**: Sterilize and build out our classification models
6. **[Pandas](https://pandas.pydata.org/)**
    - **Purpose**: Storing training, test data in native dataframes for manipulation and processing
7. **[AWS Lambda](https://aws.amazon.com/lambda/)**
    - **Purpose**: Used to build serverless functions and pipelines to access certain modules/APIs
8. **[AWS API Gateway](https://aws.amazon.com/api-gateway/)**
    - **Purpose**: Used to create HTTPS API methods for frontend access
    
### **4.4. Frameworks**
1. **[AWS]**
    - **Purpose**: Our cloud service provider will host the database, file storage, and backend
    - **Reason**: Due to our past experience and industry standard working with AWS
2. **[Express.js]**
    - **Purpose**: Our backend framework for APIs, authorization, and request handling
    - **Reason**: Due to our past experience and industry standard working with Express.js


### **4.5. Dependencies Diagram**


### **4.6. Functional Requirements Sequence Diagram**
1. [**[WRITE_NAME_HERE]**](#fr1)
[SEQUENCE_DIAGRAM_HERE]
2. ...


### **4.7. Non-Functional Requirements Design**
1. [**[WRITE_NAME_HERE]**](#nfr1)
    - **Validation**: ...
2. ...


### **4.8. Main Project Complexity Design**
**Wildfire path prediction**
- **Description**: Based on current wildfire data and location, we will attempt to compute the path of the wildfire data in the future. 
- **Why complex?**: It's complex because this will involve highly advanced algorithms to predict fire line trajectory based on metadata (like wind direction, speed, etc.). It may also involve training a model to enhance prediction. 
- **Design**:
    - **Input**: Current fire location, wind direction and speed
    - **Output**: ...
    - **Main computational logic**: ...
    - **Pseudo-code**: ...
        ```
        
        ```


## 5. Contributions
- ...
- ...
- ...
- ...

